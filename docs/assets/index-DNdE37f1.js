var W=Object.defineProperty;var D=(c,t,e)=>t in c?W(c,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[t]=e;var g=(c,t,e)=>D(c,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();class C{constructor(t,e){g(this,"canvas");g(this,"ctx");this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e;const o=this.canvas.getContext("2d");if(!o)throw new Error("Failed to get 2D context");this.ctx=o}static fromCanvas(t){const e=new C(t.width,t.height);e.canvas=t;const o=t.getContext("2d");if(!o)throw new Error("Failed to get 2D context");return e.ctx=o,e}static async fromImage(t){const e=new C(t.width,t.height);return e.ctx.drawImage(t,0,0),e}static async loadImage(t){return new Promise((e,o)=>{const i=new Image;i.onload=()=>e(i),i.onerror=o,i.src=t})}getCanvas(){return this.canvas}getContext(){return this.ctx}getWidth(){return this.canvas.width}getHeight(){return this.canvas.height}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}fill(t){this.ctx.fillStyle=this.colorToString(t),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}fillRect(t,e){this.ctx.fillStyle=this.colorToString(e),this.ctx.fillRect(t.x,t.y,t.width,t.height)}strokeRect(t,e,o){this.ctx.strokeStyle=this.colorToString(e),this.ctx.lineWidth=o,this.ctx.strokeRect(t.x+o/2,t.y+o/2,t.width-o,t.height-o)}drawLine(t,e,o,i,r,s){this.ctx.strokeStyle=this.colorToString(r),this.ctx.lineWidth=s,this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(o,i),this.ctx.stroke()}drawImage(t,e,o,i,r,s,l,n,a){const h=t instanceof C?t.getCanvas():t;this.ctx.drawImage(h,e,o,i,r,s,l,n,a)}getImageData(t){return t?this.ctx.getImageData(t.x,t.y,t.width,t.height):this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)}putImageData(t,e,o){this.ctx.putImageData(t,e,o)}getPixel(t,e){const o=this.ctx.getImageData(t,e,1,1).data;return{r:o[0],g:o[1],b:o[2],a:o[3]}}setPixel(t,e,o){const i=this.ctx.createImageData(1,1);i.data[0]=o.r,i.data[1]=o.g,i.data[2]=o.b,i.data[3]=o.a,this.ctx.putImageData(i,t,e)}detectContentBounds(t,e=10){const i=this.getImageData(t).data,r=t.width,s=t.height;let l=r,n=s,a=0,h=0,d=!1;for(let u=0;u<s;u++)for(let f=0;f<r;f++){const p=(u*r+f)*4;i[p+3]>e&&(d=!0,f<l&&(l=f),u<n&&(n=u),f>a&&(a=f),u>h&&(h=u))}return d?{minX:l,minY:n,maxX:a,maxY:h}:null}drawResized(t,e,o){this.ctx.drawImage(t.getCanvas(),e.x,e.y,e.width,e.height,o.x,o.y,o.width,o.height)}toDataURL(t="image/png"){return this.canvas.toDataURL(t)}toBlob(t="image/png"){return new Promise((e,o)=>{this.canvas.toBlob(i=>{i?e(i):o(new Error("Failed to create blob"))},t)})}downloadAsFile(t){const e=document.createElement("a");e.download=t,e.href=this.toDataURL(),e.click()}clone(){const t=new C(this.canvas.width,this.canvas.height);return t.ctx.drawImage(this.canvas,0,0),t}resize(t,e){const o=new C(t,e);return o.ctx.drawImage(this.canvas,0,0,t,e),o}colorToString(t){return`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a/255})`}static hexToColor(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16),a:255}:{r:0,g:0,b:0,a:255}}static colorToHex(t){const e=o=>o.toString(16).padStart(2,"0");return`#${e(t.r)}${e(t.g)}${e(t.b)}`}}const x=[0,2,10,8,4,6,14,12,5,7,15,13,1,3,11,9];function A(){const c=[];for(let t=0;t<16;t++)c.push(x[t]);return c.push(79),c.push(143),c.push(47),c.push(31),c.push(63),c.push(207),c.push(159),c.push(111),c.push(95),c.push(175),c.push(191),c.push(127),c.push(223),c.push(239),c.push(255),c.push(70),c.push(35),c.push(39),c.push(71),c.push(103),c.push(140),c.push(25),c.push(29),c.push(141),c.push(157),c.push(142),c.push(78),c.push(206),c.push(27),c.push(43),c.push(59),c}const G=A();class M{constructor(t){g(this,"config");this.config=t}generate(){const{tileFormat:t,tileSize:e,padding:o,offset:i}=this.config;if(t==="platformer")return this.generatePlatformerTemplate();const r=t===16?x:G,s=t===16?4:8,l=t===16?4:6,n=i+s*(e+o),a=i+l*(e+o),h=new C(n,a);for(let d=0;d<r.length;d++){const u=d%s,f=Math.floor(d/s),p=i+u*(e+o),b=i+f*(e+o);this.drawTile(h,p,b,r[d])}return h}generatePlatformerTemplate(){const{tileSize:t,padding:e,offset:o}=this.config,i=6,r=4,s=o+i*(t+e),l=o+r*(t+e),n=new C(s,l),a=n.getContext();return this.drawPlatformerTile(n,a,0,0,"floor"),this.drawPlatformerTile(n,a,1,0,"ceiling"),this.drawPlatformerTile(n,a,2,0,"wall_left"),this.drawPlatformerTile(n,a,3,0,"wall_right"),this.drawPlatformerTile(n,a,0,1,"slope_45_up"),this.drawPlatformerTile(n,a,1,1,"floor_45"),this.drawPlatformerTile(n,a,2,1,"slope_45_down"),this.drawPlatformerTile(n,a,3,1,"slope_45_ceiling_down"),this.drawPlatformerTile(n,a,4,1,"ceiling_45"),this.drawPlatformerTile(n,a,5,1,"slope_45_ceiling_up"),this.drawPlatformerTile(n,a,0,2,"slope_30_up"),this.drawPlatformerTile(n,a,1,2,"floor_30"),this.drawPlatformerTile(n,a,2,2,"slope_30_down"),this.drawPlatformerTile(n,a,3,2,"slope_30_ceiling_down"),this.drawPlatformerTile(n,a,4,2,"ceiling_30"),this.drawPlatformerTile(n,a,5,2,"slope_30_ceiling_up"),this.drawPlatformerTile(n,a,0,3,"slope_15_up"),this.drawPlatformerTile(n,a,1,3,"floor_15"),this.drawPlatformerTile(n,a,2,3,"slope_15_down"),this.drawPlatformerTile(n,a,3,3,"slope_15_ceiling_down"),this.drawPlatformerTile(n,a,4,3,"ceiling_15"),this.drawPlatformerTile(n,a,5,3,"slope_15_ceiling_up"),n}drawPlatformerTile(t,e,o,i,r){const{tileSize:s,padding:l,offset:n,fillColor:a}=this.config,h=n+o*(s+l),d=n+i*(s+l);switch(e.fillStyle=this.colorToStyle(a),r){case"floor":e.fillRect(h,d+s/2,s,s/2);break;case"ceiling":e.fillRect(h,d,s,s/2);break;case"wall_left":e.fillRect(h,d,s/2,s);break;case"wall_right":e.fillRect(h+s/2,d,s/2,s);break;case"slope_45_up":this.drawSlopePolygon(e,h,d,s,45,!1,!1);break;case"floor_45":this.drawFloorAtHeight(e,h,d,s,45,!1);break;case"slope_45_down":this.drawSlopePolygon(e,h,d,s,45,!0,!1);break;case"slope_45_ceiling_up":this.drawSlopePolygon(e,h,d,s,45,!1,!0);break;case"ceiling_45":this.drawFloorAtHeight(e,h,d,s,45,!0);break;case"slope_45_ceiling_down":this.drawSlopePolygon(e,h,d,s,45,!0,!0);break;case"slope_30_up":this.drawSlopePolygon(e,h,d,s,30,!1,!1);break;case"floor_30":this.drawFloorAtHeight(e,h,d,s,30,!1);break;case"slope_30_down":this.drawSlopePolygon(e,h,d,s,30,!0,!1);break;case"slope_30_ceiling_up":this.drawSlopePolygon(e,h,d,s,30,!1,!0);break;case"ceiling_30":this.drawFloorAtHeight(e,h,d,s,30,!0);break;case"slope_30_ceiling_down":this.drawSlopePolygon(e,h,d,s,30,!0,!0);break;case"slope_15_up":this.drawSlopePolygon(e,h,d,s,15,!1,!1);break;case"floor_15":this.drawFloorAtHeight(e,h,d,s,15,!1);break;case"slope_15_down":this.drawSlopePolygon(e,h,d,s,15,!0,!1);break;case"slope_15_ceiling_up":this.drawSlopePolygon(e,h,d,s,15,!1,!0);break;case"ceiling_15":this.drawFloorAtHeight(e,h,d,s,15,!0);break;case"slope_15_ceiling_down":this.drawSlopePolygon(e,h,d,s,15,!0,!0);break}}drawFloorAtHeight(t,e,o,i,r,s){const l=i*Math.tan(r*Math.PI/180),n=Math.min(l,i);s?t.fillRect(e,o,i,n):t.fillRect(e,o+i-n,i,n)}drawSlopePolygon(t,e,o,i,r,s,l){const n=i*Math.tan(r*Math.PI/180),a=Math.min(n,i);t.beginPath(),l?s?(t.moveTo(e,o),t.lineTo(e,o+a),t.lineTo(e+i,o),t.lineTo(e,o)):(t.moveTo(e,o),t.lineTo(e+i,o),t.lineTo(e+i,o+a),t.lineTo(e,o)):s?(t.moveTo(e,o+i),t.lineTo(e,o+i-a),t.lineTo(e+i,o+i),t.lineTo(e,o+i)):(t.moveTo(e,o+i),t.lineTo(e+i,o+i),t.lineTo(e+i,o+i-a),t.lineTo(e,o+i)),t.closePath(),t.fill()}colorToStyle(t){return`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a/255})`}getBorderColor(t){const{detailedColorMode:e,detailedColors:o,borderColor:i}=this.config;return e&&o?o[t]:i}drawTile(t,e,o,i){const{tileSize:r,fillColor:s,borderWidth:l}=this.config,n=t.getContext();t.fillRect({x:e,y:o,width:r,height:r},s),i&1||(n.fillStyle=this.colorToStyle(this.getBorderColor("top")),n.fillRect(e,o,r,l)),i&2||(n.fillStyle=this.colorToStyle(this.getBorderColor("right")),n.fillRect(e+r-l,o,l,r)),i&4||(n.fillStyle=this.colorToStyle(this.getBorderColor("bottom")),n.fillRect(e,o+r-l,r,l)),i&8||(n.fillStyle=this.colorToStyle(this.getBorderColor("left")),n.fillRect(e,o,l,r));const a=this.getBorderColor("corner");n.fillStyle=this.colorToStyle(a),!(i&1)&&!(i&8)&&n.fillRect(e,o,l,l),!(i&1)&&!(i&2)&&n.fillRect(e+r-l,o,l,l),!(i&4)&&!(i&2)&&n.fillRect(e+r-l,o+r-l,l,l),!(i&4)&&!(i&8)&&n.fillRect(e,o+r-l,l,l),this.config.tileFormat===47&&(i&1&&i&8&&!(i&16)&&n.fillRect(e,o,l,l),i&1&&i&2&&!(i&32)&&n.fillRect(e+r-l,o,l,l),i&4&&i&2&&!(i&64)&&n.fillRect(e+r-l,o+r-l,l,l),i&4&&i&8&&!(i&128)&&n.fillRect(e,o+r-l,l,l))}static drawGrid(t,e){const{tileFormat:o,tileSize:i,padding:r,offset:s}=e,l=o===16?4:8,n=o===16?4:6,a={r:128,g:128,b:128,a:180},h=t.getWidth(),d=t.getHeight();for(let u=0;u<=l;u++){const f=s+u*(i+r);f>=0&&f<=h&&t.drawLine(f,0,f,d,a,1)}for(let u=0;u<=n;u++){const f=s+u*(i+r);f>=0&&f<=d&&t.drawLine(0,f,h,f,a,1)}}static getDimensions(t){const{tileFormat:e,tileSize:o,padding:i,offset:r}=t;let s,l;e==="platformer"?(s=6,l=4):(s=e===16?4:8,l=e===16?4:6);const n=r+s*(o+i),a=r+l*(o+i);return{width:n,height:a,cols:s,rows:l}}}class H{constructor(t){g(this,"config");this.config=t}adjust(t){const{tileFormat:e,tileSize:o,padding:i,offset:r}=this.config,s=M.getDimensions(this.config),l=new C(s.width,s.height),n=[],a=e===16?16:47,h=s.cols;for(let d=0;d<a;d++){const u=d%h,f=Math.floor(d/h),p=r+u*(o+i),b=r+f*(o+i),v={x:p,y:b,width:o,height:o},I=this.estimateSourceTileRect(t,d,h,a),T=t.detectContentBounds(I);let _;if(T){const m={x:I.x+T.minX,y:I.y+T.minY,width:T.maxX-T.minX+1,height:T.maxY-T.minY+1},S=o/m.width,B=o/m.height,w=Math.min(S,B),P=m.width*w,E=m.height*w,j=(o-P)/2,R=(o-E)/2;l.drawImage(t.getCanvas(),m.x,m.y,m.width,m.height,p+j,b+R,P,E),_={index:d,original:I,detected:m,adjusted:{x:p+j,y:b+R,width:P,height:E},scale:{x:w,y:w},offset:{x:j,y:R}}}else l.drawImage(t.getCanvas(),I.x,I.y,I.width,I.height,p,b,o,o),_={index:d,original:I,detected:null,adjusted:v,scale:{x:1,y:1},offset:{x:0,y:0}};n.push(_)}return{processor:l,adjustments:n}}estimateSourceTileRect(t,e,o,i){const{tileSize:r,padding:s,offset:l}=this.config,n=e%o,a=Math.floor(e/o),h=t.getWidth(),d=t.getHeight(),u=l+o*(r+s),f=Math.ceil(i/o),p=l+f*(r+s),b=h/u,v=d/p,I=Math.round((l+n*(r+s))*b),T=Math.round((l+a*(r+s))*v),_=Math.round(r*b),m=Math.round(r*v);return{x:Math.max(0,Math.min(I,h-_)),y:Math.max(0,Math.min(T,d-m)),width:Math.min(_,h-I),height:Math.min(m,d-T)}}adjustWithContentDetection(t){const{tileFormat:e,tileSize:o,padding:i,offset:r}=this.config,s=M.getDimensions(this.config),l=new C(s.width,s.height),n=[],a=e===16?16:47,h=s.cols,d=[];for(let p=0;p<a;p++){const b=this.estimateSourceTileRect(t,p,h,a),v=t.detectContentBounds(b);v&&d.push({width:v.maxX-v.minX+1,height:v.maxY-v.minY+1})}let u=o,f=o;d.length>0&&(u=d.reduce((p,b)=>p+b.width,0)/d.length,f=d.reduce((p,b)=>p+b.height,0)/d.length);for(let p=0;p<a;p++){const b=p%h,v=Math.floor(p/h),I=r+b*(o+i),T=r+v*(o+i),_={x:I,y:T,width:o,height:o},m=this.estimateSourceTileRect(t,p,h,a),S=t.detectContentBounds(m);let B;if(S){const w={x:m.x+S.minX,y:m.y+S.minY,width:S.maxX-S.minX+1,height:S.maxY-S.minY+1},P=Math.min(o/u,o/f),E=w.width*P,j=w.height*P,R=Math.min(E,o),F=Math.min(j,o),y=Math.min(R/w.width,F/w.height),k=(o-w.width*y)/2,L=(o-w.height*y)/2;l.drawImage(t.getCanvas(),w.x,w.y,w.width,w.height,I+k,T+L,w.width*y,w.height*y),B={index:p,original:m,detected:w,adjusted:{x:I+k,y:T+L,width:w.width*y,height:w.height*y},scale:{x:y,y},offset:{x:k,y:L}}}else l.drawImage(t.getCanvas(),m.x,m.y,m.width,m.height,I,T,o,o),B={index:p,original:m,detected:null,adjusted:_,scale:{x:1,y:1},offset:{x:0,y:0}};n.push(B)}return{processor:l,adjustments:n}}}class O{constructor(){g(this,"tileFormatSelect");g(this,"tileSizeInput");g(this,"tilePaddingInput");g(this,"tileOffsetInput");g(this,"fillColorInput");g(this,"borderColorInput");g(this,"borderWidthInput");g(this,"detailedColorModeCheckbox");g(this,"detailedColorSettings");g(this,"detailedColorModeGroup");g(this,"borderColorGroup");g(this,"borderWidthGroup");g(this,"borderColorTopInput");g(this,"borderColorBottomInput");g(this,"borderColorLeftInput");g(this,"borderColorRightInput");g(this,"borderColorCornerInput");g(this,"saveTemplateBtn");g(this,"spriteInput");g(this,"autoAdjustBtn");g(this,"saveAdjustedBtn");g(this,"templateCanvas");g(this,"originalCanvas");g(this,"adjustedCanvas");g(this,"templateProcessor",null);g(this,"originalProcessor",null);g(this,"adjustedProcessor",null);this.initElements(),this.bindEvents(),this.generateTemplate()}initElements(){this.tileFormatSelect=document.getElementById("tileFormat"),this.tileSizeInput=document.getElementById("tileSize"),this.tilePaddingInput=document.getElementById("tilePadding"),this.tileOffsetInput=document.getElementById("tileOffset"),this.fillColorInput=document.getElementById("fillColor"),this.borderColorInput=document.getElementById("borderColor"),this.borderWidthInput=document.getElementById("borderWidth"),this.detailedColorModeCheckbox=document.getElementById("detailedColorMode"),this.detailedColorSettings=document.getElementById("detailedColorSettings"),this.detailedColorModeGroup=document.getElementById("detailedColorModeGroup"),this.borderColorGroup=document.getElementById("borderColorGroup"),this.borderWidthGroup=document.getElementById("borderWidthGroup"),this.borderColorTopInput=document.getElementById("borderColorTop"),this.borderColorBottomInput=document.getElementById("borderColorBottom"),this.borderColorLeftInput=document.getElementById("borderColorLeft"),this.borderColorRightInput=document.getElementById("borderColorRight"),this.borderColorCornerInput=document.getElementById("borderColorCorner"),this.saveTemplateBtn=document.getElementById("saveTemplateBtn"),this.spriteInput=document.getElementById("spriteInput"),this.autoAdjustBtn=document.getElementById("autoAdjustBtn"),this.saveAdjustedBtn=document.getElementById("saveAdjustedBtn"),this.templateCanvas=document.getElementById("templateCanvas"),this.originalCanvas=document.getElementById("originalCanvas"),this.adjustedCanvas=document.getElementById("adjustedCanvas")}bindEvents(){this.saveTemplateBtn.addEventListener("click",()=>this.saveTemplate()),this.spriteInput.addEventListener("change",e=>this.loadSprite(e)),this.autoAdjustBtn.addEventListener("click",()=>this.autoAdjust()),this.saveAdjustedBtn.addEventListener("click",()=>this.saveAdjusted()),this.detailedColorModeCheckbox.addEventListener("change",()=>{this.toggleDetailedColorSettings(),this.generateTemplate()}),this.tileFormatSelect.addEventListener("change",()=>{this.updateUIForTemplateType()}),this.updateUIForTemplateType(),[this.tileFormatSelect,this.tileSizeInput,this.tilePaddingInput,this.tileOffsetInput,this.fillColorInput,this.borderColorInput,this.borderWidthInput,this.borderColorTopInput,this.borderColorBottomInput,this.borderColorLeftInput,this.borderColorRightInput,this.borderColorCornerInput].forEach(e=>{e.addEventListener("change",()=>this.generateTemplate())})}toggleDetailedColorSettings(){this.detailedColorModeCheckbox.checked?(this.detailedColorSettings.classList.remove("hidden"),this.borderColorGroup.classList.add("hidden")):(this.detailedColorSettings.classList.add("hidden"),this.borderColorGroup.classList.remove("hidden"))}updateUIForTemplateType(){this.tileFormatSelect.value==="platformer"?(this.borderColorGroup.classList.add("hidden"),this.borderWidthGroup.classList.add("hidden"),this.detailedColorModeGroup.classList.add("hidden"),this.detailedColorSettings.classList.add("hidden")):(this.borderWidthGroup.classList.remove("hidden"),this.detailedColorModeGroup.classList.remove("hidden"),this.toggleDetailedColorSettings())}getConfig(){const t=parseInt(this.tileSizeInput.value)||64,e=parseInt(this.borderWidthInput.value)||10,o=this.detailedColorModeCheckbox.checked,i=this.tileFormatSelect.value;let r;i==="platformer"?r="platformer":r=parseInt(i);const s={tileFormat:r,tileSize:t,padding:parseInt(this.tilePaddingInput.value)||0,offset:parseInt(this.tileOffsetInput.value)||0,fillColor:C.hexToColor(this.fillColorInput.value),borderColor:C.hexToColor(this.borderColorInput.value),borderWidth:Math.min(e,Math.floor(t/2)),detailedColorMode:o};return o&&(s.detailedColors={top:C.hexToColor(this.borderColorTopInput.value),bottom:C.hexToColor(this.borderColorBottomInput.value),left:C.hexToColor(this.borderColorLeftInput.value),right:C.hexToColor(this.borderColorRightInput.value),corner:C.hexToColor(this.borderColorCornerInput.value)}),s}generateTemplate(){const t=this.getConfig(),e=new M(t);this.templateProcessor=e.generate(),this.renderPreviewWithBackground(this.templateProcessor,this.templateCanvas,t)}saveTemplate(){if(!this.templateProcessor){alert("テンプレートを生成してください");return}const t=this.tileFormatSelect.value,e=t==="platformer"?"sprite_template_platformer.png":`sprite_template_${t}tiles.png`;this.templateProcessor.downloadAsFile(e)}async loadSprite(t){var i;const o=(i=t.target.files)==null?void 0:i[0];if(o)try{const r=URL.createObjectURL(o),s=await C.loadImage(r);this.originalProcessor=await C.fromImage(s),URL.revokeObjectURL(r);const l=this.getConfig();this.renderPreviewWithBackground(this.originalProcessor,this.originalCanvas,l),this.adjustedProcessor=null,this.clearCanvas(this.adjustedCanvas)}catch(r){console.error("Failed to load image:",r),alert("画像の読み込みに失敗しました")}}autoAdjust(){if(!this.originalProcessor){alert("スプライトシート画像を読み込んでください");return}const t=this.getConfig(),o=new H(t).adjustWithContentDetection(this.originalProcessor);this.adjustedProcessor=o.processor,this.renderPreviewWithBackground(this.adjustedProcessor,this.adjustedCanvas,t),console.log("Adjustments:",o.adjustments)}saveAdjusted(){if(!this.adjustedProcessor){alert("自動調整を実行してください");return}const t=this.tileFormatSelect.value,e=t==="platformer"?"sprite_adjusted_platformer.png":`sprite_adjusted_${t}tiles.png`;this.adjustedProcessor.downloadAsFile(e)}renderPreviewWithBackground(t,e,o){const i=M.getDimensions(o),r=t.getWidth(),s=t.getHeight(),l=Math.max(i.width,r),n=Math.max(i.height,s);e.width=l,e.height=n;const a=e.getContext("2d");a&&(a.fillStyle="#3a3a3a",a.fillRect(0,0,l,n),a.drawImage(t.getCanvas(),0,0),this.drawGridOnCanvas(a,o,r,s))}drawGridOnCanvas(t,e,o,i){const{tileFormat:r,tileSize:s,padding:l,offset:n}=e,a=r===16?4:8,h=r===16?4:6;t.strokeStyle="rgba(128, 128, 128, 0.7)",t.lineWidth=1;for(let d=0;d<=a;d++){const u=n+d*(s+l);u>=0&&u<=o&&(t.beginPath(),t.moveTo(u+.5,0),t.lineTo(u+.5,i),t.stroke())}for(let d=0;d<=h;d++){const u=n+d*(s+l);u>=0&&u<=i&&(t.beginPath(),t.moveTo(0,u+.5),t.lineTo(o,u+.5),t.stroke())}}clearCanvas(t){const e=t.getContext("2d");e&&e.clearRect(0,0,t.width,t.height)}}document.addEventListener("DOMContentLoaded",()=>{new O});
